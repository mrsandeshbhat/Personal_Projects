function J = an_jac(A,TA)
z0 = [0; 0; 1];
p0 = [0;0;0];
z1 = A{1}(1:3,3);
p1 = A{1}(1:3,4);
T02 = A{1}*A{2};
z2 = T02(1:3,3);
p2 = T02(1:3,4);
T03 = T02*A{3};
z3 = T03(1:3,3);
p3 = T03(1:3,4);
T04 = T03*A{4};
z4 = T04(1:3,3);
p4 = T04(1:3,4);
T05 = T04*A{5};
z5 = T05(1:3,3);
p5 = T05(1:3,4);
T06 = T05*A{6};
z6 = T06(1:3,3);
p6 = T06(1:3,4);
T07 = T06*A{7};
p7 = T07(1:3,4);
J1 = [cross(z0,p7-p0), cross(z1,p7-p1), cross(z2,p7-p2), cross(z3,p7-p3),...
    cross(z4,p7-p4),cross(z5,p7-p5),cross(z6,p7-p6);
    z0, z1, z2, z3, z4, z5, z6];
J = TA\J1;